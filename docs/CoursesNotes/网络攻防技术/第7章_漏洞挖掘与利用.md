# 模糊测试
一种自动化或半自动化的软件安全漏洞检测技术，通过向目标软件输入大量的畸形数据并监测目标系统的异常来发现潜在的软件漏洞。
属于黑盒测试，缺点是畸形数据的生成具有随机性，而随机性造成代码覆盖不充分导致测试数据覆盖率不高。
## 模糊测试分类

- 基于生成的模糊测试：它是指依据特定的文件格式或者协议规范组合生成测试用例，该方法的关键点在于既要遵守被测程序的输入数据的规范要求，又要能变异出区别于正常的数据。
- 基于变异的模糊测试：它是指在原有合法的测试用例基础上，通过变异策略生成新的测试用例。变异策略可以是随机变异策略、边界值变异策略、位变异策略等等，但前提条件是给定的初始测试用例是合法的输入。

## 模糊测试步骤

1. 确定测试对象和输入数据
2. 生成模糊测试数据
3. 检测模糊测试数据
4. 监测程序异常
5. 确定可利用性

## 智能模糊测试
为了解决随机性带来的测试性能不高的问题，引入了基于符号执行、污点传播分析等可进行程序理解的方法，有针对性的设计测试数据的生成，从而实现了比传统的随机模糊测试更高的效率，这种结合了程序理解和模糊测试的方法，称为智能模糊测试技术。
### 智能模糊测试具体步骤

1. 反汇编
2. 中间语言转换
3. 采用智能技术分析输入数据和执行路径的关系：通过符号执行和约束求解技术、污点传播分析、执行路径遍历等技术手段，检测出可能产生漏洞的程序执行路径集合和输入数据集合。
4. 利用分析获得的输入数据集合，对执行路径集合进行测试

### 智能模糊测试的核心思想
在于以尽可能小的代价找出程序中最有可能产生漏洞的执行路径集合，从而避免了盲目地对程序进行全路径覆盖测试，使得漏洞分析更有针对性。
# AFL 模糊测试框架
基于覆盖引导 (Coverage-guided) 的模糊测试工具，它通过记录输入样本的代码覆盖率，从而调整输入样本以提高覆盖率，增加发现漏洞的概率。
## AFL 的工作流程

- 从源码编译程序时进行插桩，以便记录代码覆盖率
- 选择一些输入文件作为初始测试集加入输入队列
- 将队列中的文件按策略进行 “变异”
- 如果经过变异文件更新了覆盖范围，则保留在队列中
- 循环进行，期间触发了 crash 的文件会被记录下来
