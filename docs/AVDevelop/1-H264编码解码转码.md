# 第一节 H264 编码解码转码

## 1 音视频基础

这里我打算写一下新的概念以及一些刚入门的疑惑。

### 1.1 YUV 与 RGB

我接触较多的是 RGB，这种对像素的描述我们很好理解，就是通过三个分量 R、G 和 B 获得各种颜色。但是 YUV 这种格式采用了一种完全不同的想法，也许我们可以用轮廓和颜色来表示，也就是把色彩和轮廓分离了，先给出一张黑白图片，再通过 UV 分量进行渲染。

后面会提到，YUV 更适合人眼，因为人眼对一些信息的敏感度更高，对于 Y 分量描述的轮廓更敏感，因此我们可以适当压缩 UV 分量，实现有损压缩。当然也可以选择不压缩，这取决于我们。

### 1.2 视频压缩

通过上面的编码我们就可以表示一张图片了，而视频压缩的本质就是信息存在冗余，主要就是以下几方面：

- 空间冗余：同一帧图片，相邻的块有相似的信息
- 时间冗余：相邻的帧差别可能很小，有大量的重复信息
- 视觉冗余：针对人而言，对部分细节不敏感，对低频信息可以压缩
- 信息冗余：不同的信息出现的频率不同，参考哈夫曼编码，可以让高频出现的使用比较小的数字表示，使用位数就少

但是宇宙总是存在某一种平衡，以上种种，要么损失了信息，要么就是用时间换空间。

### 1.3 图像帧的类型

- I 帧：关键帧，这种帧只存在帧内预测，不会参考前后帧
- B 帧：双向帧，会参考前后的帧
- P 帧：P 帧会参考前面的帧

B 帧会带来编码延迟，因为如果参考后面的帧，那么需要先编码后面的帧，这里如果连续出现 B 帧，那么是否有可能出现大延迟。使用 B 帧会导致编码顺序和显示顺序混乱，因此一般在直播等场景很少使用。